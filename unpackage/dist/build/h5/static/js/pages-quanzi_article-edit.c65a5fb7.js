(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-quanzi_article-edit"],{1046:function(t,i,e){var n=e("dd3a");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=e("4f06").default;a("548884fc",n,!0,{sourceMap:!1,shadowMode:!1})},"20af":function(t,i,e){"use strict";(function(t){e("7a82");var n=e("4ea4").default;Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=n(e("c7eb")),o=n(e("b85c")),c=n(e("1da1"));e("d3b7"),e("ac1f"),e("baa5");var s=e("6115"),l=t.database(),r={data:function(){return{toolShow:!1,headShow:!1,boldShow:!1,italicShow:!1,formData:{user_id:"",title:"",description:"",province:"",content:"",article_status:0,delState:null,state:null,view_count:null,like_count:null,comment_count:null,picurls:[]},formOptions:{article_status_localdata:[{value:0,text:"草稿箱"},{value:1,text:"已发布"}]}}},onLoad:function(t){if(t.id){var i=t.id;this.formDataId=i,this.getDetail(i)}},onReady:function(){this.onEditReady()},methods:{submit:function(){var t=this;this.editorCtx.getContents({success:function(i){t.formData.content=i.html,t.formData.picurls=(0,s.getImgSrc)(i.html),uni.showLoading({title:"发布中..."}),t.addData()}})},addData:function(){var t=this;l.collection("quanzi_article").doc(this.formDataId).update({title:this.formData.title,content:this.formData.content}).then((function(i){uni.hideLoading(),uni.showToast({title:"发布成功"}),setTimeout((function(){uni.redirectTo({url:"/pages/quanzi_article/detail?id="+t.formDataId})}),800)}))},getDetail:function(t){var i=this;uni.showLoading({mask:!0}),l.collection("quanzi_article").doc(t).field("user_id,title,description,province,content,excerpt,article_status,delState,state,view_count,like_count,comment_count,last_comment_user_id,picurls,publish_date,publish_ip,last_modify_date,last_modify_ip").get().then((function(t){var e=t.result.data[0];e&&(i.formData=e,console.log(i.formData.content),i.onEditReady())})).catch((function(t){uni.showModal({content:t.message||"请求服务失败",showCancel:!1})})).finally((function(){uni.hideLoading()}))},onEditReady:function(){var t=this;uni.createSelectorQuery().in(this).select(".myEdit").fields({size:!0,context:!0},(function(i){t.editorCtx=i.context,t.editorCtx.setContents({html:t.formData.content})})).exec()},checkStatus:function(t,i,e){i.hasOwnProperty(t)?this[e]=!0:this[e]=!1},onStatuschange:function(t){var i=t.detail;this.checkStatus("header",i,"headShow"),this.checkStatus("bold",i,"boldShow"),this.checkStatus("italic",i,"italicShow")},clickInsertImage:function(){var i=this;uni.chooseImage({success:function(){var e=(0,c.default)((0,a.default)().mark((function e(n){var c,s,l,r,d,u;return(0,a.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:uni.showLoading({title:"上传中请稍后",mask:!0}),c=(0,o.default)(n.tempFiles),e.prev=2,c.s();case 4:if((s=c.n()).done){e.next=14;break}return l=s.value,r=l.path.substring(l.path.lastIndexOf(".")),d=Date.now()+""+String(Math.random()).substr(3,6)+r,e.next=10,t.uploadFile({filePath:l.path,cloudPath:l.name||d});case 10:u=e.sent,i.editorCtx.insertImage({src:u.fileID});case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e["catch"](2),c.e(e.t0);case 19:return e.prev=19,c.f(),e.finish(19);case 22:uni.hideLoading();case 23:case"end":return e.stop()}}),e,null,[[2,16,19,22]])})));return function(t){return e.apply(this,arguments)}}()})},editOk:function(){this.toolShow=!1},clickBold:function(){this.boldShow=!this.boldShow,this.editorCtx.format("bold")},clickItalic:function(){this.italicShow=!this.italicShow,this.editorCtx.format("italic")},clickHead:function(){this.headShow=!this.headShow,this.editorCtx.format("header",!!this.headShow&&"H2")},clickDivider:function(){this.editorCtx.insertDivider()},onFocus:function(){this.toolShow=!0}}};i.default=r}).call(this,e("a9ff")["default"])},"7a44":function(t,i,e){"use strict";var n=e("1046"),a=e.n(n);a.a},"98d7":function(t,i,e){"use strict";e.d(i,"b",(function(){return a})),e.d(i,"c",(function(){return o})),e.d(i,"a",(function(){return n}));var n={uButton:e("18c2").default},a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("v-uni-view",{staticClass:"edit"},[e("v-uni-view",{staticClass:"title"},[e("v-uni-input",{attrs:{type:"text","placeholder-class":"placeholderClass"},model:{value:t.formData.title,callback:function(i){t.$set(t.formData,"title",i)},expression:"formData.title"}})],1),e("v-uni-view",{staticClass:"content"},[e("v-uni-editor",{staticClass:"myEdit",attrs:{placeholder:"写点什么吧~~","show-img-size":!0,"show-img-toolbar":!0,"show-img-resize":!0},on:{ready:function(i){arguments[0]=i=t.$handleEvent(i),t.onEditReady.apply(void 0,arguments)},focus:function(i){arguments[0]=i=t.$handleEvent(i),t.onFocus.apply(void 0,arguments)},statuschange:function(i){arguments[0]=i=t.$handleEvent(i),t.onStatuschange.apply(void 0,arguments)}}})],1),e("v-uni-view",{staticClass:"btnGroup"},[e("u-button",{attrs:{type:"primary",text:"确认发表",disabled:!t.formData.title.length},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.submit.apply(void 0,arguments)}}})],1),t.toolShow?e("v-uni-view",{staticClass:"tools"},[e("v-uni-view",{staticClass:"item",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.clickHead.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"iconfont icon-zitibiaoti",class:t.headShow?"active":""})],1),e("v-uni-view",{staticClass:"item",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.clickBold.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"iconfont icon-zitijiacu",class:t.boldShow?"active":""})],1),e("v-uni-view",{staticClass:"item",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.clickItalic.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"iconfont icon-zitixieti",class:t.italicShow?"active":""})],1),e("v-uni-view",{staticClass:"item",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.clickDivider.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"iconfont icon-fengexian"})],1),e("v-uni-view",{staticClass:"item",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.clickInsertImage.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"iconfont icon-charutupian"})],1),e("v-uni-view",{staticClass:"item",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.editOk.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"iconfont icon-duigou_kuai"})],1)],1):t._e()],1)},o=[]},a9d7:function(t,i,e){"use strict";e.r(i);var n=e("20af"),a=e.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){e.d(i,t,(function(){return n[t]}))}(o);i["default"]=a.a},dd3a:function(t,i,e){var n=e("24fb");i=n(!1),i.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */[data-v-13784434] .ql-blank::before{font-style:normal;color:#e0e0e0}\r\n/*scoped /deep/.title{\r\n\t\tinput{\r\n\t\t\theight: 120rpx;\r\n\t\t\tfont-size: 46rpx;\r\n\t\t\tborder-bottom:1px solid #e4e4e4;\r\n\t\t\tmargin-bottom:30rpx;\r\n\t\t\tcolor:#000;\r\n\t\t\tfont-weight:400;\r\n\t\t}\r\n\t\t.placeholderClass{\r\n\t\t\tcolor:#e0e0e0;\r\n\t\t}\r\n\t\t}} */.edit[data-v-13784434]{padding:%?30?%}.edit .title uni-input[data-v-13784434]{height:%?120?%;font-size:%?46?%;border-bottom:1px solid #e4e4e4;margin-bottom:%?30?%;color:#000}.edit .title .placeholderClass[data-v-13784434]{color:#e0e0e0}.edit .content .myEdit[data-v-13784434]{height:calc(100vh - %?500?%);margin-bottom:%?30?%}.edit .tools[data-v-13784434]{width:100%;height:%?80?%;background:#fff;border-top:%?1?% solid #f4f4f4;position:fixed;left:0;bottom:0;display:flex;justify-content:space-around;align-items:center}.edit .tools .iconfont[data-v-13784434]{font-size:%?36?%;color:#333}.edit .tools .iconfont.active[data-v-13784434]{color:#0199fe}.state[data-v-13784434]{display:flex;flex-direction:row}.state .leftext[data-v-13784434]{width:25%}.uni-forms-item__label[data-v-13784434]{width:100px}.uni-forms-item[data-v-13784434] .is-direction-left{margin-bottom:0;background-color:#ffaa7f}',""]),t.exports=i},e7b9:function(t,i,e){"use strict";e.r(i);var n=e("98d7"),a=e("a9d7");for(var o in a)["default"].indexOf(o)<0&&function(t){e.d(i,t,(function(){return a[t]}))}(o);e("7a44");var c=e("f0c5"),s=Object(c["a"])(a["default"],n["b"],n["c"],!1,null,"13784434",null,!1,n["a"],void 0);i["default"]=s.exports}}]);